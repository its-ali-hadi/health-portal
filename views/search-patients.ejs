<%- include('partials/header', { title: 'ุจุญุซ ุนู ุงููุฑุถู' }) %>

<main class="container">
    <h1>ุฅุฏุงุฑุฉ ุจูุงูุงุช ุงููุฑุถู</h1>
    
    <div class="search-card">
        <form action="/search-patients" method="GET" class="search-form">
            <div class="form-group">
                <input type="text" 
                       name="query" 
                       value="<%= searchQuery || '' %>" 
                       placeholder="ุงุจุญุซ ุจุงููุฑูุถ (ุงูุงุณูุ ุงูุจุฑูุฏุ ุงููุงุชูุ ID)"
                       aria-label="ุจุญุซ ุนู ุงููุฑุถู"
                       required>
                <button type="submit" class="btn btn-search">
                    <i class="search-icon">๐</i> ุจุญุซ
                </button>
            </div>
        </form>
        
        <% if (searchQuery && resultsCount === 0) { %>
            <div class="empty-state" >
                <p>ูุง ุชูุฌุฏ ูุชุงุฆุฌ ูู "<%= searchQuery %>"</p>
                <a href="/search-patients" class="btn">ุนุฑุถ ุฌููุน ุงููุฑุถู</a>
            </div>
        <% } else if (resultsCount > 0) { %>
            <div class="results-header">
                <p>ุนุฑุถ <%= resultsCount %> ูุชูุฌุฉ</p>
            </div>
            
            <div class="patients-grid" >
                <% patients.forEach(patient => { %>
                    <div class="patient-card" style="box-shadow: 0 6px 10px rgba(0,0,0,0.1);">
                        <div class="patient-avatar">
                            <img src="<%= patient.image || '/images/default-avatar.png' %>" 
                                 alt="ุตูุฑุฉ <%= patient.name %>">
                        </div>
                        <div class="patient-details">
                            <h3><%= patient.name %></h3>
                            <p><%= patient.email || 'ูุง ููุฌุฏ ุจุฑูุฏ' %></p>
                            <p><%= patient.phone || 'ูุง ููุฌุฏ ูุงุชู' %></p>
                            <p class="patient-id">ID: <%= patient.id %></p>
                        </div>
                        <div class="patient-actions">
                            <% if(currentUser.role === 'lab') { %>
                                <a href="/lab-write/<%= patient.id %>" 
                                   class="btn btn-primary">
                                   ูุชุงุจุฉ ูุชุฆุงุฌ ุงูุชุญุงููู
                                </a>
                                <br>
                                <a href="/patient/<%= patient.id %>" class="btn btn-primary">ุงูููู ุงูุดุฎุตู ูููุฑูุถ</a>
                            <% } else { %>
                            <a href="/write-prescription/<%= patient.id %>" 
                               class="btn btn-primary">
                               ูุชุงุจุฉ ูุตูุฉ
                            </a>
                            <% } %>
                        </div>
                    </div>
                <% }); %>
            </div>
        <% } else { %>
            <div class="empty-state">
                <p>ุงุณุชุฎุฏู ูุฑุจุน ุงูุจุญุซ ุฃุนูุงู ููุนุซูุฑ ุนูู ุงููุฑุถู</p>
            </div>
        <% } %>
    </div>
</main>

<%- include('partials/footer') %>